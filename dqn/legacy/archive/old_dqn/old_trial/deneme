python3 - <<'PY'
import torch
from train_dqn import evaluate, DQN
from snake_env import ACTION_SET

input_size = 8*8 + 3  # grid + [danger_straight, danger_left, danger_right]
policy = DQN(input_size, len(ACTION_SET))
policy.load_state_dict(torch.load("dqn_snake.pt", map_location="cpu"))
evaluate(policy, episodes=20, width=8, height=8)
PY